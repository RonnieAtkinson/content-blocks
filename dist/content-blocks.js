!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("ContentBlocks",[],e):"object"==typeof exports?exports.ContentBlocks=e():t.ContentBlocks=e()}(self,(function(){return(()=>{"use strict";var t={d:(e,n)=>{for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};function n(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=r(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var a=0,o=function(){};return{s:o,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,i=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return i=t.done,t},e:function(t){l=!0,s=t},f:function(){try{i||null==n.return||n.return()}finally{if(l)throw s}}}}function r(t,e){if(t){if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}t.d(e,{FormConnect:()=>rt});var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,s;return e=t,s=[{key:"removeClassFromChildren",value:function(t,e,r){if(!t||!e)throw new Error("To remove classes from children a required parameter is missing");var a,o=n(t.getElementsByClassName(e));try{for(o.s();!(a=o.n()).done;)a.value.classList.remove(r||e)}catch(t){o.e(t)}finally{o.f()}}},{key:"targetHasClass",value:function(t,e){if(!t||!e)throw new Error("To check if a target has a class a required parameter is missing");if(e.some((function(e){return t.classList.contains(e)})))return t.classList}},{key:"toggleClassesOnNodeList",value:function(t,e){if(!e||!t)throw new Error("To add a class to a node list a required paramater is missing");var r,a=n(e);try{var o=function(){var e=r.value;t.map((function(t){return e.classList.toggle(t)}))};for(a.s();!(r=a.n()).done;)o()}catch(t){a.e(t)}finally{a.f()}}},{key:"removeClassesFromNodeList",value:function(t,e){if(!e||!t)throw new Error("To remove a class from a node list a required paramater is missing");var o,s,i=n(e);try{for(i.s();!(o=i.n()).done;){var l;(l=o.value.classList).remove.apply(l,function(t){if(Array.isArray(t))return a(t)}(s=t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(s)||r(s)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())}}catch(t){i.e(t)}finally{i.f()}}}],null&&o(e.prototype,null),s&&o(e,s),Object.defineProperty(e,"prototype",{writable:!1}),t}();function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var c=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,n=[{key:"generateName",value:function(t,e,n){if(!t||!e)throw new Error("An index and key are required to generate a name");var r="postContent[a".concat(t,"][").concat(e,"]");return!0===n?r+"[]":r}},{key:"updateIndexInNames",value:function(t,e){var n,r=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){l=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw o}}}}(t.querySelectorAll('[name^="postContent"]'));try{for(r.s();!(n=r.n()).done;){var a=n.value;a.name=a.name.replace(/(\d+)+/g,(function(t,n){return e}))}}catch(t){r.e(t)}finally{r.f()}}}],null&&l(e.prototype,null),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var f=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,n=[{key:"updateWrapperIndexes",value:function(t){var e,n=1,r=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return u(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){i=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(i)throw o}}}}(t);try{for(r.s();!(e=r.n()).done;){var a=e.value;a.dataset.index=n,c.updateIndexInNames(a,n),n++}}catch(t){r.e(t)}finally{r.f()}}}],null&&d(e.prototype,null),n&&d(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var b=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,n=[{key:"isNullUndefindedEmpty",value:function(t){return null==t||""===t}}],null&&p(e.prototype,null),n&&p(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function y(t){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y(t)}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var m=function(){function t(e){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),!e)throw new Error("The kind of element you want to create is required as the first parameter");this.el=document.createElement(e)}var e,n;return e=t,(n=[{key:"addAttributes",value:function(t){if(!t)throw new Error("No attributes were provided");if("object"!=y(t))throw new Error("Attributes need to be passed as an object, eg: { name: 'foo', id: 'bar' }");for(var e in t)if(!b.isNullUndefindedEmpty(t[e]))if("object"==y(t[e])){for(var n in t[e])if(!b.isNullUndefindedEmpty(t[e][n]))if("classList"===e)this.el[e].add(t[e][n]);else{if("dataset"!==e)throw new Error("An object was provided as the value of '".concat(e,"'. Objects can only be used with 'classList' or 'dataset'."));this.el[e][n]=t[e][n]}}else this.el[e]=t[e];return this}},{key:"appendTo",value:function(t){return t.appendChild(this.el),this}},{key:"prependTo",value:function(t){return t.prepend(this.el),this}},{key:"insertBeforeEl",value:function(t){return t.parentElement.insertBefore(this.el,t),this}}])&&h(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function g(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var v=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,n=[{key:"getClassNamesFor",value:function(t,e){var n=e[t];return Array.isArray(n)?n:"string"==typeof n?[n]:[]}}],null&&g(e.prototype,null),n&&g(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function k(t){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},k(t)}function C(t){return function(t){if(Array.isArray(t))return w(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return w(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function N(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function E(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?N(Object(n),!0).forEach((function(e){O(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function O(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function D(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var j={},A=function(){function t(e,n,r,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.index=e+1,this.contentBlocksParentEl=n,this.options=E(E({},j),r),this.dragDrop=a}var e,n;return e=t,(n=[{key:"getClassNameFor",value:function(t){return v.getClassNamesFor(t,this.options.classes)[0]}},{key:"getClassNamesFor",value:function(t){return v.getClassNamesFor(t,this.options.classes)}},{key:"addDynamicButtonsTo",value:function(t){return new m("button").addAttributes({type:"button",textContent:this.options.text["button:addDynamic"],classList:C(this.getClassNamesFor("button:addDynamic"))}).appendTo(t),new m("button").addAttributes({type:"button",textContent:this.options.text["button:removeDynamic"],classList:C(this.getClassNamesFor("button:removeDynamic")),disabled:!0}).appendTo(t),this}},{key:"addTabButtons",value:function(t,e){var n=new m("div").addAttributes({classList:C(this.getClassNamesFor("block:nav"))}).appendTo(e).el;for(var r in t){var a=new m("button").addAttributes({type:"button",textContent:t[r].display||this.options.text["button:tab:default"],classList:[].concat(C(this.getClassNamesFor("button:tab")),["".concat(this.getClassNameFor("button:tab"),"--").concat(r)]),dataset:{target:"".concat(this.getClassNameFor("block:tab"),"--").concat(r)}}).appendTo(n).el;t[r].active&&(a.disabled=!0,a.classList.add(this.getClassNameFor("button:tab:active")))}}},{key:"addTabContainers",value:function(t,e){var n={};for(var r in t){var a=new m("div").addAttributes({classList:[].concat(C(this.getClassNamesFor("block:tab")),["".concat(this.getClassNameFor("block:tab"),"--").concat(r)])}).appendTo(e).el;t[r].active&&a.classList.add(this.getClassNamesFor("block:tab:active")),n[r]=a}return n}},{key:"addBlockWrapper",value:function(t){var e,n=new m("fieldset").addAttributes({classList:[].concat(C(this.getClassNamesFor("block:single")),["".concat(this.getClassNameFor("block:single"),"--").concat(t)]),dataset:{index:this.index}}).el;return this.dragDrop.dragState&&((e=n.classList).add.apply(e,C(this.getClassNamesFor("drag:draggable"))),n.draggable=!0),n}},{key:"addBlockTitleTo",value:function(t,e){var n=e.display,r=e.icon,a=new m("legend").addAttributes({textContent:n,classList:this.getClassNamesFor("block:title")}).appendTo(t).el;return r&&new m("i").addAttributes({classList:[].concat(C(this.getClassNamesFor("block:icon")),["".concat(this.getClassNameFor("block:icon"),"--").concat(r)])}).prependTo(a),this}},{key:"addFormGroup",value:function(t,e,n,r){var a=n.tab,o=Object.keys(t).length>0?t[a]:t;if(b.isNullUndefindedEmpty(o))throw new Error("".concat(n.label," has been assigned to a tab that hasn't been defined"));var s,i=!!(n.element||{}).node,l="variation"===e&&!!Object.keys(r||{}).length&&i,u=!!(n||{}).dynamic,d=new m(u?"fieldset":"div").addAttributes({classList:[].concat(C(this.getClassNamesFor("form:group")),["".concat(this.getClassNameFor("form:group"),"--").concat(e)],C((n.attributes||{}).classList||[])),dataset:(n.attributes||{}).data}).appendTo(o).el;if(u)return new m("legend").addAttributes({textContent:(n||{}).label}).appendTo(d),void this.addDynamicButtonsTo(d);if(i){var f=new m("label").addAttributes({textContent:(n||{}).label}).appendTo(d).el;s=new m(n.element.node).addAttributes(E(E({},n.element.attributes||{}),{},{name:c.generateName(this.index,e),classList:[].concat(C(this.getClassNamesFor("form:control")),C((n.element.attributes||{}).classList||[]))})).appendTo(f).el}if(l)for(var p in r)new m("option").addAttributes({value:p,textContent:r[p].display}).appendTo(s)}},{key:"addContentBlock",value:function(t,e){if(!t)throw new Error("No content type provided for this block");var n=e||{},r=n.display,a=n.icon,o=n.formGroups,s=n.variations,i=n.tabs;if(!r||!o)throw new Error("Invalid options provided for the ".concat(t," content block"));if("object"!=k(o)||!Object.keys(o).length)throw new Error("No form controls were passed");var l=!!i,u=this.addBlockWrapper(t);this.addBlockTitleTo(u,{display:r,icon:a}),new m("button").addAttributes({type:"button",textContent:this.options.text["button:removeBlock"],classList:this.getClassNamesFor("button:removeBlock")}).appendTo(u),l&&this.addTabButtons(i,u),new m("input").addAttributes({type:"hidden",value:t,name:c.generateName(this.index,"type")}).appendTo(u);var d=l?this.addTabContainers(i,u):u;for(var f in o)this.addFormGroup(d,f,o[f],s);this.contentBlocksParentEl.appendChild(u),this.dragDrop.isDragAllowed()&&(this.dragDrop.toggleDragEl.disabled=!1)}}])&&D(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function F(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return L(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?L(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){i=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(i)throw o}}}}function L(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function B(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function T(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?B(Object(n),!0).forEach((function(e){S(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function S(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function P(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function x(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var I={initialDragState:!1},q=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};P(this,t),this.contentBlocksParentEl=e,this.contentBlocksLNL=n,this.options=T(T({},I),r),this.dragState=this.options.initialDragState,this.toggleDragEl=this.contentBlocksParentEl.querySelector(".".concat(this.getClassNameFor("button:toggleDrag"))),this.dragListeners()}var e,n;return e=t,(n=[{key:"getClassNameFor",value:function(t){return v.getClassNamesFor(t,this.options.classes)[0]}},{key:"getClassNamesFor",value:function(t){return v.getClassNamesFor(t,this.options.classes)}},{key:"isDragAllowed",value:function(){return this.contentBlocksLNL.length>1}},{key:"disableDrag",value:function(){this.dragState=!1,this.toggleDragEl.disabled=!0,this.toggleDragEl.checked=!1,this.toggleDragEl.classList.remove(this.getClassNameFor("button:toggleDrag:active")),s.removeClassesFromNodeList(this.getClassNamesFor("drag:draggable"),this.contentBlocksLNL);var t,e=F(this.contentBlocksLNL);try{for(e.s();!(t=e.n()).done;)t.value.draggable=!1}catch(t){e.e(t)}finally{e.f()}}},{key:"handleDragToggle",value:function(t){if(this.isDragAllowed()){this.toggleDragEl.classList.toggle(this.getClassNameFor("button:toggleDrag:active")),s.toggleClassesOnNodeList(this.getClassNamesFor("drag:draggable"),this.contentBlocksLNL),this.dragState=!this.contentBlocksLNL[0].draggable;var e,n=F(this.contentBlocksLNL);try{for(n.s();!(e=n.n()).done;)e.value.draggable=this.dragState}catch(t){n.e(t)}finally{n.f()}}}},{key:"handleDragStart",value:function(t){var e=t.target.closest(".".concat(this.getClassNameFor("block:single")));e.draggable&&(t.dataTransfer.setData("text/plain",e.dataset.index),t.dataTransfer.effectAllowed="move")}},{key:"handleDragEnd",value:function(t){"none"===t.dataTransfer.dropEffect&&s.removeClassFromChildren(this.contentBlocksParentEl,this.getClassNameFor("drag:droppable")),f.updateWrapperIndexes(this.contentBlocksLNL)}},{key:"handleDragEnter",value:function(t){var e=t.target.closest(".".concat(this.getClassNameFor("block:single")));e&&"text/plain"===t.dataTransfer.types[0]&&(e.classList.add(this.getClassNameFor("drag:droppable")),t.preventDefault())}},{key:"handleDragOver",value:function(t){"text/plain"===t.dataTransfer.types[0]&&t.preventDefault()}},{key:"handleDragLeave",value:function(t){var e=t.target.closest(".".concat(this.getClassNameFor("block:single")));e&&t.relatedTarget&&t.relatedTarget.closest(".".concat(this.getClassNameFor("block:single")))!==e&&s.removeClassFromChildren(this.contentBlocksParentEl,this.getClassNameFor("drag:droppable"))}},{key:"handleDragDrop",value:function(t){t.preventDefault();var e=t.target.closest(".".concat(this.getClassNameFor("block:single"))),n=t.dataTransfer.getData("text/plain"),r=document.querySelector("[data-index='".concat(n,"']"));e&&e.parentElement&&(e.parentElement.insertBefore(r,e),e.classList.remove(this.getClassNameFor("drag:droppable")))}},{key:"dragListeners",value:function(){return this.contentBlocksParentEl.addEventListener("dragstart",this.handleDragStart.bind(this)),this.contentBlocksParentEl.addEventListener("dragend",this.handleDragEnd.bind(this)),this.contentBlocksParentEl.addEventListener("dragenter",this.handleDragEnter.bind(this)),this.contentBlocksParentEl.addEventListener("dragover",this.handleDragOver.bind(this)),this.contentBlocksParentEl.addEventListener("dragleave",this.handleDragLeave.bind(this)),this.contentBlocksParentEl.addEventListener("drop",this.handleDragDrop.bind(this)),this.toggleDragEl.addEventListener("change",this.handleDragToggle.bind(this)),this}}])&&x(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function G(t){return function(t){if(Array.isArray(t))return _(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||U(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function H(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=U(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){i=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(i)throw o}}}}function U(t,e){if(t){if("string"==typeof t)return _(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(t,e):void 0}}function _(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function M(t){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},M(t)}function R(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function W(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function $(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function V(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?$(Object(n),!0).forEach((function(e){J(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function J(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var z={"block:wrapper":"content-blocks-wrapper","block:parent":"content-blocks","block:single":"content-block","block:title":"content-block__title","block:nav":"content-block__nav","block:tab":"content-block__tab","block:tab:active":"active","block:icon":"icon","form:group":"form-group","form:control":"form-control","button:wrapper":"content-blocks-buttons","button:addBlock":"bt-add-group","button:removeBlock":"bt-remove-group","button:addDynamic":"bt-add","button:removeDynamic":"bt-remove","button:tab":"bt-tab","button:tab:active":"active","button:toggleDrag":"bt-toggle-draggable","button:toggleDrag:active":"active","drag:droppable":"droppable","drag:draggable":"draggable"},K={"button:removeBlock":"Remove","button:addDynamic":"Add","button:removeDynamic":"Remove","button:tab:default":"Content"},Q={},X={tab:"classes",label:"Classes",dynamic:!0,attributes:{data:{el:"input",type:"text",name:"class",placeholder:"Class name"}}},Y={label:"Paragraph",dynamic:!0,attributes:{data:{el:"textarea",name:"content"}}},Z={label:"Content",element:{node:"textarea"}},tt={label:"Content",element:{node:"input",attributes:{type:"text"}}},et={label:"Variation",element:{node:"select"}},nt={intro:{display:"Introduction",icon:"intro",tabs:{content:{display:"Content",active:!0},classes:{display:"Classes"}},formGroups:{content:V(V({},Z),{},{tab:"content"}),classes:V({},X)}},link:{display:"Link",icon:"link",tabs:{content:{display:"Content",active:!0},classes:{display:"Classes"}},variations:{internal:{display:"Internal"},external:{display:"External"}},formGroups:{variation:V(V({},et),{},{tab:"content"}),linkText:V(V({},tt),{},{tab:"content",label:"Link Text",element:V(V({},tt.element),{},{attributes:V(V({},tt.element.attributes),{},{placeholder:"Link text label"})})}),linkUrl:V(V({},tt),{},{tab:"content",label:"Link URL",element:V(V({},tt.element),{},{attributes:V(V({},tt.element.attributes),{},{placeholder:"Link URL"})})}),classes:V({},X)}},paragraph:{display:"Paragraph",icon:"paragraph",tabs:{content:{display:"Content",active:!0},classes:{display:"Classes"}},formGroups:{paragraph:V(V({},Y),{},{label:"Content",tab:"content"}),classes:V({},X)}},heading:{display:"Heading",icon:"heading",tabs:{content:{display:"Content",active:!0},classes:{display:"Classes"}},variations:{h2:{display:"H2"},h3:{display:"H3"},h4:{display:"H4"},h5:{display:"H5"},h6:{display:"H6"}},formGroups:{variation:V(V({},et),{},{tab:"content"}),content:V(V({},tt),{},{tab:"content",element:V(V({},tt.element),{},{attributes:V(V({},tt.element.attributes),{},{placeholder:"Heading text"})})}),classes:V({},X)}},infoBox:{display:"Information Box",icon:"info",tabs:{content:{display:"Content",active:!0},classes:{display:"Classes"}},variations:{positive:{display:"Positive"},negative:{display:"Negative"},neutral:{display:"Neutral"}},formGroups:{variation:V(V({},et),{},{tab:"content"}),title:V(V({},tt),{},{tab:"content",label:"Title",element:V(V({},tt.element),{},{attributes:V(V({},tt.element.attributes),{},{placeholder:"Box title"})})}),paragraph:V(V({},Y),{},{tab:"content"}),classes:V({},X)}},code:{display:"Code Block",icon:"code",tabs:{content:{display:"Content",active:!0},classes:{display:"Classes"}},variations:{html:{display:"HTML"},javascript:{display:"Javascript"}},formGroups:{variation:V(V({},et),{},{tab:"content",label:"Language"}),content:V(V({},Z),{},{tab:"content"}),classes:V({},X)}}},rt=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(R(this,t),!e||"FORM"!=e.nodeName)throw new Error("A valid form node is required to connect a form");if(!n||"object"!=M(n))throw new Error("Content groups must be passed as an object. Currently ".concat("undefined"==typeof contentGroups?"undefined":M(contentGroups)));this.ACTION_ADD="add",this.ACTION_REMOVE="remove",this.formEl=e,this.contentGroups=V(V({},nt),n),this.options=V(V(V({},Q),r),{},{text:V(V({},K),r.text||{}),classes:V(V({},z),r.classes||{}),exclude:{defaultBlocks:(r.exclude||[]).defaultBlocks||[]}}),this.options.exclude.defaultBlocks.length>0&&this.excludeDefaultBlocks(),this.contentBlocksWrapperEl=this.formEl.querySelector(".".concat(this.getClassNameFor("block:wrapper"))),this.contentBlocksParentEl=this.contentBlocksWrapperEl.querySelector(".".concat(this.getClassNameFor("block:parent"))),this.contentBlocksButtonWrapperEl=this.contentBlocksWrapperEl.querySelector(".".concat(this.getClassNameFor("button:wrapper"))),this.contentBlocksLNL=this.contentBlocksParentEl.getElementsByClassName(this.getClassNameFor("block:single")),this.dragDrop=new q(this.contentBlocksParentEl,this.contentBlocksLNL,this.options),this.render()}var e,n;return e=t,(n=[{key:"excludeDefaultBlocks",value:function(){var t,e=H(this.options.exclude.defaultBlocks);try{for(e.s();!(t=e.n()).done;){var n=t.value;delete this.contentGroups[n]}}catch(t){e.e(t)}finally{e.f()}return this}},{key:"getClassNameFor",value:function(t){return v.getClassNamesFor(t,this.options.classes)[0]}},{key:"getClassNamesFor",value:function(t){return v.getClassNamesFor(t,this.options.classes)}},{key:"toggleDynamicRemoveButton",value:function(t,e,n){if(!t||b.isNullUndefindedEmpty(e))throw new Error("To toggle the remove button a required parameter is missing");if(![this.ACTION_ADD,this.ACTION_REMOVE].includes(n))throw new Error("To toggle the remove button the action parmeter needs to be 'add' or 'remove'. ".concat(n," was provided."));var r=0===e;n===this.ACTION_ADD&&e>1||n===this.ACTION_REMOVE&&!r||(t.disabled=r)}},{key:"addDynamicElement",value:function(t,e,n){var r=t.closest(".".concat(this.getClassNameFor("block:single"))).dataset.index,a=t.closest(".".concat(this.getClassNameFor("form:group"))).dataset,o=a.name,s=a.type,i=a.placeholder,l={name:c.generateName(r,o,!0),classList:G(this.getClassNamesFor("form:control"))};return s&&(l.type=s),i&&(l.placeholder=i),new m(e).addAttributes(l).insertBeforeEl(t),this.toggleDynamicRemoveButton(t.nextElementSibling,n.length,this.ACTION_ADD),this}},{key:"removeDynamicElement",value:function(t,e){var n=e.length;if(0!==n)return e[n-1].parentElement.removeChild(e[n-1]),this.toggleDynamicRemoveButton(t,e.length,this.ACTION_ADD),this}},{key:"addContentButtons",value:function(){for(var t in this.contentGroups){var e=this.contentGroups[t],n=e.icon,r=e.display,a=new m("button").addAttributes({type:"button",textContent:r,classList:[].concat(G(this.getClassNamesFor("button:addBlock")),["".concat(this.getClassNameFor("button:addBlock"),"--").concat(t)]),dataset:{group:t}}).appendTo(this.contentBlocksButtonWrapperEl).el;n&&new m("i").addAttributes({classList:[].concat(G(this.getClassNamesFor("block:icon")),["".concat(this.getClassNameFor("block:icon"),"--").concat(n)])}).prependTo(a)}}},{key:"removeContentBlock",value:function(t){t&&(t.remove(),f.updateWrapperIndexes(this.contentBlocksLNL),this.dragDrop.isDragAllowed()||this.dragDrop.disableDrag())}},{key:"switchToTab",value:function(t){var e,n,r=t.closest(".".concat(this.getClassNameFor("block:single"))),a=t.parentElement,o=t.dataset.target,i=H(a.querySelectorAll("button"));try{for(i.s();!(n=i.n()).done;){var l,c=n.value;(l=c.classList).remove.apply(l,G(this.getClassNamesFor("button:tab:active"))),c.disabled=!1}}catch(t){i.e(t)}finally{i.f()}(e=t.classList).add.apply(e,G(this.getClassNamesFor("button:tab:active"))),t.disabled=!0,s.removeClassFromChildren(r,this.getClassNameFor("block:tab"),this.getClassNameFor("block:tab:active")),r.querySelector(".".concat(o)).classList.add(this.getClassNameFor("block:tab:active"))}},{key:"handleFormClicks",value:function(t){var e=t.target;if("BUTTON"==e.nodeName&&"button"===e.type){var n,r;if(s.targetHasClass(e,[this.getClassNameFor("button:addDynamic"),this.getClassNameFor("button:removeDynamic")])){if(!(r=e.closest(".".concat(this.getClassNameFor("form:group"))).dataset.el))throw new Error("No data-el on the parent element");n=e.parentElement.getElementsByTagName(r)}switch(e.classList){case s.targetHasClass(e,G(this.getClassNamesFor("button:addDynamic"))):this.addDynamicElement(e,r,n);break;case s.targetHasClass(e,G(this.getClassNamesFor("button:removeDynamic"))):this.removeDynamicElement(e,n);break;case s.targetHasClass(e,G(this.getClassNamesFor("button:addBlock"))):new A(this.contentBlocksLNL.length,this.contentBlocksParentEl,this.options,this.dragDrop).addContentBlock(e.dataset.group,this.contentGroups[e.dataset.group]);break;case s.targetHasClass(e,G(this.getClassNamesFor("button:removeBlock"))):this.removeContentBlock(e.parentElement);break;case s.targetHasClass(e,[this.getClassNameFor("button:tab")]):this.switchToTab(e)}return this}}},{key:"formListener",value:function(){return this.contentBlocksWrapperEl.addEventListener("click",this.handleFormClicks.bind(this)),this}},{key:"render",value:function(){return this.addContentButtons(),this.formListener(),this}}])&&W(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();return e.FormConnect})()}));