!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("FormConnect",[],e):"object"==typeof exports?exports.FormConnect=e():t.FormConnect=e()}(self,(function(){return(()=>{"use strict";var t={d:(e,n)=>{for(var a in n)t.o(n,a)&&!t.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:n[a]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};function n(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=a(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,i=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return i=t.done,t},e:function(t){l=!0,s=t},f:function(){try{i||null==n.return||n.return()}finally{if(l)throw s}}}}function a(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function o(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}t.d(e,{FormConnect:()=>x});var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,s;return e=t,s=[{key:"removeClassFromChildren",value:function(t,e,a){if(!t||!e)throw new Error("To remove classes from children a required parameter is missing");var r,o=n(t.getElementsByClassName(e));try{for(o.s();!(r=o.n()).done;)r.value.classList.remove(a||e)}catch(t){o.e(t)}finally{o.f()}}},{key:"targetHasClass",value:function(t,e){if(!t||!e)throw new Error("To check if a target has a class a required parameter is missing");if(e.some((function(e){return t.classList.contains(e)})))return t.classList}},{key:"toggleClassesOnNodeList",value:function(t,e){if(!e||!t)throw new Error("To add a class to a node list a required paramater is missing");var a,r=n(e);try{var o=function(){var e=a.value;t.map((function(t){return e.classList.toggle(t)}))};for(r.s();!(a=r.n()).done;)o()}catch(t){r.e(t)}finally{r.f()}}},{key:"removeClassesFromNodeList",value:function(t,e){if(!e||!t)throw new Error("To remove a class from a node list a required paramater is missing");var o,s,i=n(e);try{for(i.s();!(o=i.n()).done;){var l;(l=o.value.classList).remove.apply(l,function(t){if(Array.isArray(t))return r(t)}(s=t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(s)||a(s)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())}}catch(t){i.e(t)}finally{i.f()}}}],null&&o(e.prototype,null),s&&o(e,s),Object.defineProperty(e,"prototype",{writable:!1}),t}();function i(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}var l=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,n=[{key:"isNullUndefindedEmpty",value:function(t){return null==t||""===t}}],null&&i(e.prototype,null),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function d(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}var u=function(){function t(e){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),!e)throw new Error("The kind of element you want to create is required as the first parameter");this.el=document.createElement(e)}var e,n;return e=t,(n=[{key:"addAttributes",value:function(t){if(!t)throw new Error("No attributes were provided");if("object"!=c(t))throw new Error("Attributes need to be passed as an object, eg: { name: 'foo', id: 'bar' }");for(var e in t)if(!l.isNullUndefindedEmpty(t[e]))if("object"==c(t[e])){for(var n in t[e])if(!l.isNullUndefindedEmpty(t[e][n]))if("classList"===e)this.el[e].add(t[e][n]);else{if("dataset"!==e)throw new Error("An object was provided as the value of '".concat(e,"'. Objects can only be used with 'classList' or 'dataset'."));this.el[e][n]=t[e][n]}}else this.el[e]=t[e];return this}},{key:"appendTo",value:function(t){return t.appendChild(this.el),this}},{key:"insertBeforeEl",value:function(t){return t.parentElement.insertBefore(this.el,t),this}}])&&d(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function f(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return b(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?b(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var a=0,r=function(){};return{s:r,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){i=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(i)throw o}}}}function b(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}var m=function(){function t(e,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};p(this,t),this.contentBlocksLNL=n,this.options=a,this.dragState=this.options.initialDragState,this.contentBlocksParentEl=e,this.toggleDragEl=this.contentBlocksParentEl.querySelector(".".concat(this.getClassNameFor("button:toggleDrag"))),this.dragListeners()}var e,n;return e=t,(n=[{key:"getClassNameFor",value:function(t){return this.getClassNamesFor(t)[0]}},{key:"getClassNamesFor",value:function(t){var e=this.options.classes[t];return Array.isArray(e)?e:"string"==typeof e?[e]:[]}},{key:"updateIndexInNames",value:function(t,e){var n,a=f(t.querySelectorAll('[name^="postContent"]'));try{for(a.s();!(n=a.n()).done;){var r=n.value;r.name=r.name.replace(/(\d+)+/g,(function(t,n){return e}))}}catch(t){a.e(t)}finally{a.f()}}},{key:"updateWrapperIndexes",value:function(){var t,e=1,n=f(this.contentBlocksLNL);try{for(n.s();!(t=n.n()).done;){var a=t.value;a.dataset.id=e,this.updateIndexInNames(a,e),e++}}catch(t){n.e(t)}finally{n.f()}}},{key:"isDragAllowed",value:function(){return this.contentBlocksLNL.length>1}},{key:"disableDrag",value:function(){this.dragState=!1,this.toggleDragEl.disabled=!0,this.toggleDragEl.checked=!1,this.toggleDragEl.classList.remove(this.getClassNameFor("button:toggleDrag:active")),s.removeClassesFromNodeList(this.getClassNamesFor("drag:draggable"),this.contentBlocksLNL);var t,e=f(this.contentBlocksLNL);try{for(e.s();!(t=e.n()).done;)t.value.draggable=!1}catch(t){e.e(t)}finally{e.f()}}},{key:"handleDragToggle",value:function(t){if(this.isDragAllowed()){this.toggleDragEl.classList.toggle(this.getClassNameFor("button:toggleDrag:active")),s.toggleClassesOnNodeList(this.getClassNamesFor("drag:draggable"),this.contentBlocksLNL),this.dragState=!this.contentBlocksLNL[0].draggable;var e,n=f(this.contentBlocksLNL);try{for(n.s();!(e=n.n()).done;)e.value.draggable=this.dragState}catch(t){n.e(t)}finally{n.f()}}}},{key:"handleDragStart",value:function(t){var e=t.target.closest(".".concat(this.getClassNameFor("block:single")));e.draggable&&(t.dataTransfer.setData("text/plain",e.dataset.id),t.dataTransfer.effectAllowed="move")}},{key:"handleDragEnd",value:function(t){"none"===t.dataTransfer.dropEffect&&s.removeClassFromChildren(this.contentBlocksParentEl,this.getClassNameFor("drag:droppable")),this.updateWrapperIndexes()}},{key:"handleDragEnter",value:function(t){var e=t.target.closest(".".concat(this.getClassNameFor("block:single")));e&&"text/plain"===t.dataTransfer.types[0]&&(e.classList.add(this.getClassNameFor("drag:droppable")),t.preventDefault())}},{key:"handleDragOver",value:function(t){"text/plain"===t.dataTransfer.types[0]&&t.preventDefault()}},{key:"handleDragLeave",value:function(t){var e=t.target.closest(".".concat(this.getClassNameFor("block:single")));e&&t.relatedTarget&&t.relatedTarget.closest(".".concat(this.getClassNameFor("block:single")))!==e&&s.removeClassFromChildren(this.contentBlocksParentEl,this.getClassNameFor("drag:droppable"))}},{key:"handleDragDrop",value:function(t){t.preventDefault();var e=t.target.closest(".".concat(this.getClassNameFor("block:single"))),n=t.dataTransfer.getData("text/plain"),a=document.querySelector("[data-id='".concat(n,"']"));e&&e.parentElement&&(e.parentElement.insertBefore(a,e),e.classList.remove(this.getClassNameFor("drag:droppable")))}},{key:"dragListeners",value:function(){return this.contentBlocksParentEl.addEventListener("dragstart",this.handleDragStart.bind(this)),this.contentBlocksParentEl.addEventListener("dragend",this.handleDragEnd.bind(this)),this.contentBlocksParentEl.addEventListener("dragenter",this.handleDragEnter.bind(this)),this.contentBlocksParentEl.addEventListener("dragover",this.handleDragOver.bind(this)),this.contentBlocksParentEl.addEventListener("dragleave",this.handleDragLeave.bind(this)),this.contentBlocksParentEl.addEventListener("drop",this.handleDragDrop.bind(this)),this.toggleDragEl.addEventListener("change",this.handleDragToggle.bind(this)),this}}])&&h(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function g(t){return function(t){if(Array.isArray(t))return C(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||v(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=v(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var a=0,r=function(){};return{s:r,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){i=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(i)throw o}}}}function v(t,e){if(t){if("string"==typeof t)return C(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?C(t,e):void 0}}function C(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function k(t){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},k(t)}function w(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function N(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function E(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function D(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?E(Object(n),!0).forEach((function(e){F(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function F(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var B={"block:wrapper":"content-blocks-wrapper","block:parent":"content-blocks","block:single":"content-blocks__single","form:control":"form-control","content:tab":"content-tab","content:active":"active","button:wrapper":"content-blocks-buttons","button:addBlock":"bt-add-group","button:removeBlock":"bt-remove-group","button:addDynamic":"bt-add","button:removeDynamic":"bt-remove","button:tab":"bt-tab","button:tab:active":"active","button:tab:wrapper":"tabbing-buttons","button:toggleDrag":"bt-toggle-draggable","button:toggleDrag:active":"active","drag:droppable":"droppable","drag:draggable":"draggable"},L={"button:removeBlock":"Remove","button:addDynamic":"Add","button:removeDynamic":"Remove","button:tab:default":"Content"},A={initialDragState:!1},T={tab:"classes",label:"Classes",dynamic:!0,attributes:{data:{el:"input",type:"text",name:"class"}}},O={intro:{display:"Introduction",tabs:{content:{display:"Content",active:!0},classes:{display:"Classes"}},formControls:{content:{tab:"content",label:"Content",element:{node:"textarea",attributes:{}}},classes:D({},T)}},link:{display:"Link",tabs:{content:{display:"Content",active:!0},classes:{display:"Classes"}},variations:{internal:{display:"Internal"},external:{display:"External"}},formControls:{variation:{tab:"content",label:"variation",element:{node:"select"}},linkText:{tab:"content",label:"Link Text",element:{node:"input",attributes:{type:"text",placeholder:"test"}}},linkUrl:{tab:"content",label:"Link URL",element:{node:"input",attributes:{type:"text"}}},classes:D({},T)}},paragraph:{display:"Paragraph",tabs:{content:{display:"Content",active:!0},classes:{display:"Classes"}},formControls:{content:{tab:"content",label:"Content",element:{node:"textarea",attributes:{}}},classes:D({},T)}},heading:{display:"Heading",tabs:{content:{display:"Content",active:!0},classes:{display:"Classes"}},variations:{h2:{display:"H2"},h3:{display:"H3"},h4:{display:"H4"},h5:{display:"H5"},h6:{display:"H6"}},formControls:{variation:{tab:"content",label:"variation",element:{node:"select",attributes:{}}},content:{tab:"content",label:"Content",element:{node:"input",attributes:{type:"text"}}},classes:D({},T)}},infoBox:{display:"Information Box",tabs:{content:{display:"Content",active:!0},classes:{display:"Classes"}},variations:{positive:{display:"Positive"},negative:{display:"Negative"},neutral:{display:"Neutral"}},formControls:{variation:{tab:"content",label:"variation",element:{node:"select",attributes:{}}},title:{tab:"content",label:"Title",element:{node:"input",attributes:{type:"text"}}},paragraph:{tab:"content",label:"Paragraph",dynamic:!0,attributes:{data:{el:"textarea",name:"content"}}},classes:D({},T)}},code:{display:"Code Block",tabs:{content:{display:"Content",active:!0},classes:{display:"Classes"}},variations:{html:{display:"HTML"},javascript:{display:"Javascript"}},formControls:{variation:{tab:"content",label:"Language",element:{node:"select",attributes:{}}},content:{tab:"content",label:"Content",element:{node:"textarea",attributes:{}}},classes:D({},T)}}},x=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(w(this,t),!e||"FORM"!=e.nodeName)throw new Error("A valid form node is required to connect a form");if(!n||"object"!=k(n))throw new Error("Content groups must be passed as an object. Currently ".concat("undefined"==typeof contentGroups?"undefined":k(contentGroups)));this.ACTION_ADD="add",this.ACTION_REMOVE="remove",this.formEl=e,this.contentGroups=D(D({},O),n),this.options=D(D(D({},A),a),{},{text:D(D({},L),a.text||{}),classes:D(D({},B),a.classes||{}),exclude:{defaultBlocks:(a.exclude||[]).defaultBlocks||[]}}),this.options.exclude.defaultBlocks.length>0&&this.excludeDefaultBlocks(),this.contentBlocksWrapperEl=this.formEl.querySelector(".".concat(this.getClassNameFor("block:wrapper"))),this.contentBlocksParentEl=this.contentBlocksWrapperEl.querySelector(".".concat(this.getClassNameFor("block:parent"))),this.contentBlocksButtonWrapperEl=this.contentBlocksWrapperEl.querySelector(".".concat(this.getClassNameFor("button:wrapper"))),this.contentBlocksLNL=this.contentBlocksParentEl.getElementsByClassName(this.getClassNameFor("block:single")),this.dragDrop=new m(this.contentBlocksParentEl,this.contentBlocksLNL,this.options),this.render()}var e,n;return e=t,(n=[{key:"excludeDefaultBlocks",value:function(){var t,e=y(this.options.exclude.defaultBlocks);try{for(e.s();!(t=e.n()).done;){var n=t.value;delete this.contentGroups[n]}}catch(t){e.e(t)}finally{e.f()}return this}},{key:"getClassNameFor",value:function(t){return this.getClassNamesFor(t)[0]}},{key:"getClassNamesFor",value:function(t){var e=this.options.classes[t];return Array.isArray(e)?e:"string"==typeof e?[e]:[]}},{key:"generateName",value:function(t,e,n){if(!t||!e)throw new Error("An index and key are required to generate a name");var a="postContent[a".concat(t,"][").concat(e,"]");return!0===n?a+"[]":a}},{key:"addDynamicButtonsTo",value:function(t){return new u("button").addAttributes({type:"button",textContent:this.options.text["button:addDynamic"],classList:g(this.getClassNamesFor("button:addDynamic"))}).appendTo(t),new u("button").addAttributes({type:"button",textContent:this.options.text["button:removeDynamic"],classList:g(this.getClassNamesFor("button:removeDynamic")),disabled:!0}).appendTo(t),this}},{key:"toggleDynamicRemoveButton",value:function(t,e,n){if(!t||l.isNullUndefindedEmpty(e))throw new Error("To toggle the remove button a required parameter is missing");if(![this.ACTION_ADD,this.ACTION_REMOVE].includes(n))throw new Error("To toggle the remove button the action parmeter needs to be 'add' or 'remove'. ".concat(n," was provided."));var a=0===e;n===this.ACTION_ADD&&e>1||n===this.ACTION_REMOVE&&!a||(t.disabled=a)}},{key:"addDynamicElement",value:function(t,e,n){var a=t.closest(".".concat(this.getClassNameFor("block:single"))).dataset.id,r=t.closest(".".concat(this.getClassNameFor("form:control"))).dataset,o=r.name,s=r.type,i={name:this.generateName(a,o,!0)};return s&&(i.type=s),new u(e).addAttributes(i).insertBeforeEl(t),this.toggleDynamicRemoveButton(t.nextElementSibling,n.length,this.ACTION_ADD),this}},{key:"removeDynamicElement",value:function(t,e){var n=e.length;if(0!==n)return e[n-1].parentElement.removeChild(e[n-1]),this.toggleDynamicRemoveButton(t,e.length,this.ACTION_ADD),this}},{key:"addContentButtons",value:function(){for(var t in this.contentGroups)new u("button").addAttributes({type:"button",textContent:this.contentGroups[t].display,classList:[].concat(g(this.getClassNamesFor("button:addBlock")),["".concat(this.getClassNameFor("button:addBlock"),"--").concat(t)]),dataset:{group:t}}).appendTo(this.contentBlocksButtonWrapperEl)}},{key:"addTabButtons",value:function(t,e){var n=new u("div").addAttributes({classList:g(this.getClassNamesFor("button:tab:wrapper"))}).appendTo(e).el;for(var a in t){var r=new u("button").addAttributes({type:"button",textContent:t[a].display||this.options.text["button:tab:default"],classList:[].concat(g(this.getClassNamesFor("button:tab")),["".concat(this.getClassNameFor("button:tab"),"--").concat(a)]),dataset:{target:"".concat(this.getClassNameFor("content:tab"),"--").concat(a)}}).appendTo(n).el;t[a].active&&(r.disabled=!0,r.classList.add(this.getClassNameFor("button:tab:active")))}}},{key:"addTabContainers",value:function(t,e){var n={};for(var a in t){var r=new u("div").addAttributes({classList:[].concat(g(this.getClassNamesFor("content:tab")),["".concat(this.getClassNameFor("content:tab"),"--").concat(a)])}).appendTo(e).el;t[a].active&&r.classList.add(this.getClassNamesFor("content:active")),n[a]=r}return n}},{key:"addContentBlockFormControls",value:function(t,e,n,a){if("object"!=k(e)||!Object.keys(e).length)throw new Error("No form controls were passed");for(var r in e){var o=e[r].tab,s=Object.keys(t).length>0?t[o]:t;if(l.isNullUndefindedEmpty(s))throw new Error("".concat(e[r].label," has been assigned to a tab that hasn't been defined"));var i=!!(e[r].element||{}).node,c="variation"===r&&!!Object.keys(n||{}).length&&i,d=!!(e[r]||{}).dynamic,f=new u(d?"fieldset":"div").addAttributes({classList:[].concat(g(this.getClassNamesFor("form:control")),["".concat(this.getClassNameFor("form:control"),"--").concat(r)]),dataset:(e[r].attributes||{}).data}).appendTo(s).el,b=void 0;if(d)new u("legend").addAttributes({textContent:(e[r]||{}).label}).appendTo(f),this.addDynamicButtonsTo(f);else if(new u("label").addAttributes({textContent:(e[r]||{}).label,htmlFor:"test"}).appendTo(f),i&&(b=new u(e[r].element.node).addAttributes(D(D({},e[r].element.attributes||{}),{},{name:this.generateName(a,r)})).appendTo(f).el),c)for(var p in n)new u("option").addAttributes({value:p,textContent:n[p].display}).appendTo(b)}}},{key:"addContentBlock",value:function(t){if(!t)throw new Error("No content type provided for this block");var e=this.contentGroups[t]||{},n=e.display,a=e.formControls,r=e.variations,o=e.tabs;if(!n||!a)throw new Error("Invalid options provided for the ".concat(t," content block"));var s,i=this.contentBlocksLNL.length+1,l=!!o,c=new u("fieldset").addAttributes({classList:[].concat(g(this.getClassNamesFor("block:single")),["".concat(this.getClassNameFor("block:single"),"--").concat(t)]),dataset:{id:i}}).el;this.dragDrop.dragState&&((s=c.classList).add.apply(s,g(this.getClassNamesFor("drag:draggable"))),c.draggable=!0),new u("legend").addAttributes({textContent:n}).appendTo(c),new u("button").addAttributes({type:"button",textContent:this.options.text["button:removeBlock"],classList:this.getClassNamesFor("button:removeBlock")}).appendTo(c),l&&this.addTabButtons(o,c),new u("input").addAttributes({type:"hidden",value:t,name:this.generateName(i,"type")}).appendTo(c);var d=l?this.addTabContainers(o,c):c;this.addContentBlockFormControls(d,a,r,i),this.contentBlocksParentEl.appendChild(c),this.dragDrop.isDragAllowed()&&(this.dragDrop.toggleDragEl.disabled=!1)}},{key:"removeContentBlock",value:function(t){t&&(t.remove(),this.dragDrop.updateWrapperIndexes(),this.dragDrop.isDragAllowed()||this.dragDrop.disableDrag())}},{key:"switchToTab",value:function(t){var e,n,a=t.closest(".".concat(this.getClassNameFor("block:single"))),r=t.parentElement,o=t.dataset.target,i=y(r.querySelectorAll("button"));try{for(i.s();!(n=i.n()).done;){var l,c=n.value;(l=c.classList).remove.apply(l,g(this.getClassNamesFor("button:tab:active"))),c.disabled=!1}}catch(t){i.e(t)}finally{i.f()}(e=t.classList).add.apply(e,g(this.getClassNamesFor("button:tab:active"))),t.disabled=!0,s.removeClassFromChildren(a,this.getClassNameFor("content:tab"),this.getClassNameFor("content:active")),a.querySelector(".".concat(o)).classList.add(this.getClassNameFor("content:active"))}},{key:"handleFormClicks",value:function(t){var e=t.target;if("BUTTON"==e.nodeName&&"button"===e.type){var n,a;if(s.targetHasClass(e,[this.getClassNameFor("button:addDynamic"),this.getClassNameFor("button:removeDynamic")])){if(!(a=e.closest(".".concat(this.getClassNameFor("form:control"))).dataset.el))throw new Error("No data-el on the parent element");n=e.parentElement.getElementsByTagName(a)}switch(e.classList){case s.targetHasClass(e,g(this.getClassNamesFor("button:addDynamic"))):this.addDynamicElement(e,a,n);break;case s.targetHasClass(e,g(this.getClassNamesFor("button:removeDynamic"))):this.removeDynamicElement(e,n);break;case s.targetHasClass(e,g(this.getClassNamesFor("button:addBlock"))):this.addContentBlock(e.dataset.group);break;case s.targetHasClass(e,g(this.getClassNamesFor("button:removeBlock"))):this.removeContentBlock(e.parentElement);break;case s.targetHasClass(e,[this.getClassNameFor("button:tab")]):this.switchToTab(e)}return this}}},{key:"formListener",value:function(){return this.contentBlocksWrapperEl.addEventListener("click",this.handleFormClicks.bind(this)),this}},{key:"render",value:function(){return this.addContentButtons(),this.formListener(),this}}])&&N(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();return e.FormConnect})()}));